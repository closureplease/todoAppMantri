var goog=goog||{};var Todos={ctrls:{}};Todos.ctrls.Todos=Ember.Controller.extend({entries:function(){var a=this.getPath("content.filterBy");if(Ember.empty(a))return this.get("content");if(!Ember.compare(a,"completed"))return this.get("content").filterProperty("completed",!0);if(!Ember.compare(a,"active"))return this.get("content").filterProperty("completed",!1)}.property("content.remaining")});Todos.Router=Ember.Router.extend({root:Ember.Route.extend({showAll:Ember.Route.transitionTo("index"),showActive:Ember.Route.transitionTo("active"),showCompleted:Ember.Route.transitionTo("completed"),index:Ember.Route.extend({route:"/",connectOutlets:function(a){a=a.get("applicationController");var b=a.namespace.entriesController;b.set("filterBy","");a.connectOutlet({viewClass:Todos.views.Items,controller:Todos.ctrls.Todos.create(),context:b})}}),active:Ember.Route.extend({route:"/active",connectOutlets:function(a){a=
a.get("applicationController");var b=a.namespace.entriesController;b.set("filterBy","active");a.connectOutlet({viewClass:Todos.views.Items,controller:Todos.ctrls.Todos.create(),context:b})}}),completed:Ember.Route.extend({route:"/completed",connectOutlets:function(a){a=a.get("applicationController");var b=a.namespace.entriesController;b.set("filterBy","completed");a.connectOutlet({viewClass:Todos.views.Items,controller:Todos.ctrls.Todos.create(),context:b})}}),specs:Ember.Route.extend({route:"/specs",
connectOutlets:Todos.helper})})});Todos.views={};Todos.views.ClearButton=Ember.View.extend({entriesBinding:"controller.namespace.entriesController",templateName:"clear_button",classNameBindings:"buttonClass",buttonClass:function(){if(!this.getPath("entries.completed"))return"hidden"}.property("entries.completed")});Todos.views.Stats=Ember.View.extend({entriesBinding:"controller.namespace.entriesController",elementId:"todo-count",tagName:"span",templateName:"stats",oneLeft:function(){return 1===this.getPath("entries.remaining")}.property("entries.remaining")});Todos.views.Filters=Ember.View.extend({templateName:"filters",filterBinding:"controller.namespace.entriesController.filterBy",isAll:function(){return Ember.empty(this.get("filter"))}.property("filter"),isActive:function(){return"active"===this.get("filter")}.property("filter"),isCompleted:function(){return"completed"===this.get("filter")}.property("filter")});Todos.views.Application=Ember.ContainerView.extend({childViews:["headerView","mainView","footerView"],headerView:Ember.ContainerView.create({childViews:["titleView","createTodoView"],elementId:"header",tagName:"header",titleView:Ember.View.create({tagName:"h1",template:function(){return"todos"}}),createTodoView:Ember.TextField.create({entriesBinding:"controller.namespace.entriesController",placeholder:"What needs to be done?",elementId:"new-todo",insertNewline:function(){var a=this.get("value");a&&
(this.get("entries").createNew(a),this.set("value",""))}})}),mainView:Em.ContainerView.create({elementId:"main",tagName:"section",visibilityBinding:"controller.namespace.entriesController.noneLeft",classNameBindings:["visibility:hidden"],childViews:["outletView","markAllChkbox"],outletView:Ember.View.create({template:Ember.Handlebars.compile("{{outlet}}")}),markAllChkbox:Ember.Checkbox.create({entriesBinding:"controller.namespace.entriesController",elementId:"toggle-all",checkedBinding:"entries.allAreDone"})}),
footerView:Ember.ContainerView.create({elementId:"footer",tagName:"footer",visibilityBinding:"controller.namespace.entriesController.noneLeft",classNameBindings:["visibility:hidden"],childViews:[Todos.views.Stats.create(),Todos.views.Filters.create(),Todos.views.ClearButton.create()]})});Todos.models={};Todos.models.Todo=Ember.Object.extend({id:null,title:null,completed:!1,store:null,todoChanged:function(){this.get("store").update(this)}.observes("title","completed")});Todos.models.Store=function(a){this.name=a;this.data=(a=localStorage.getItem(this.name))&&JSON.parse(a)||{};this.save=function(){localStorage.setItem(this.name,JSON.stringify(this.data))};this.createFromTitle=function(a){a=Todos.models.Todo.create({title:a,store:this});this.create(a);return a};this.create=function(a){a.get("id")||a.set("id",Date.now());return this.update(a)};this.update=function(a){this.data[a.get("id")]=a.getProperties("id","title","completed");this.save();return a};this.find=function(a){a=
Todos.models.Todo.create(this.data[a.get("id")]);a.set("store",this);return a};this.findAll=function(){var a=[],c;for(c in this.data){var d=Todos.models.Todo.create(this.data[c]);d.set("store",this);a.push(d)}return a};this.remove=function(a){delete this.data[a.get("id")];this.save();return a}};Todos.ctrls.Entries=Ember.ArrayProxy.extend({store:null,content:[],createNew:function(a){a.trim()&&(a=this.get("store").createFromTitle(a),this.pushObject(a))},pushObject:function(a,b){b||this.get("store").create(a);return this._super(a)},removeObject:function(a){this.get("store").remove(a);return this._super(a)},clearCompleted:function(){this.filterProperty("completed",!0).forEach(this.removeObject,this)},total:function(){return this.get("length")}.property("@each.length"),remaining:function(){return this.filterProperty("completed",
!1).get("length")}.property("@each.completed"),completed:function(){return this.filterProperty("completed",!0).get("length")}.property("@each.completed"),noneLeft:function(){return 0===this.get("total")}.property("total"),allAreDone:function(a,b){return void 0!==b?(this.setEach("completed",b),b):!!this.get("length")&&this.everyProperty("completed",!0)}.property("@each.completed"),init:function(){this._super();var a=this.get("store").findAll();a.get("length")&&this.set("[]",a)}});Todos.app={};Todos.App=Ember.Application.create({VERSION:"1.0",rootElement:"#todoapp",Router:Router,ApplicationController:Ember.Controller.extend(),ApplicationView:ApplicationView,entriesController:EntriesController.create({store:new Store("todos-emberjs")}),ready:function(){this.initialize()}});
