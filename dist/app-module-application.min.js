var COMPILED=true;var goog=goog||{};var Todos={todoMVCspec:function(){describe("TodoMVC features.",function(){var b=$.Event("keyup",{keyCode:13});describe("Todo creation:",function(){beforeEach(function(){window.location.hash="#/"});it("should allow creating a new todo",function(){runs(function(){$("#new-todo").val("Foo Bar Todo").trigger(b)});waits(100);runs(function(){!!$("#todo-list li").text().match("Foo Bar Todo")})});it("should not allow adding an empty todo",function(){var a=$("#todo-list li").length;runs(function(){$("#new-todo").val("   ").trigger(b)});
waits(100);runs(function(){expect($("#todo-list li").length).toEqual(a)})})});describe("Todo completion:",function(){it("should allow marking a todo complete",function(){var a,c=$("#todo-list li.completed").length;runs(function(){$("#new-todo").val("Foo Bar Todo to be completed").trigger(b)});waits(100);runs(function(){a=$("#todo-list li:last-child");expect(a.text()).toMatch(" to be completed");a.find(".toggle").click();expect($("#todo-list li.completed").length).toEqual(c+1)})});it("should allow clearing completed todos",
function(){var a;$("#todo-list li.completed");runs(function(){$("#new-todo").val("Foo Bar Todo to be completed").trigger(b)});waits(100);runs(function(){a=$("#todo-list li:last-child");expect(a.text()).toMatch(" to be completed");a.find(".toggle").click();$("#clear-completed").click();expect($("#todo-list li.completed").length).toEqual(0)})})});describe("Todo deletion:",function(){it("should allow deleting a todo",function(){var a,c=$("#todo-list li").length;runs(function(){$("#new-todo").val("Foo Bar Todo to be deleted").trigger(b)});
waits(100);runs(function(){a=$("#todo-list li:last-child");expect(a.text()).toMatch(" to be deleted");a.find(".destroy").click();expect($("#todo-list li").length).toEqual(c)})})})})}};Todos.helper=function(){Todos.todoMVCspec();var b=jasmine.getEnv(),a=new jasmine.HtmlReporter;b.addReporter(a);b.execute()};Todos.ctrls={};Todos.ctrls.Todos=Ember.Controller.extend({entries:function(){var b=this.getPath("content.filterBy");if(Ember.empty(b))return this.get("content");if(!Ember.compare(b,"completed"))return this.get("content").filterProperty("completed",!0);if(!Ember.compare(b,"active"))return this.get("content").filterProperty("completed",!1)}.property("content.remaining")});Todos.views={};
Todos.views.Items=Ember.CollectionView.extend({contentBinding:"controller.entries",tagName:"ul",elementId:"todo-list",itemViewClass:Ember.View.extend({templateName:"items",classNames:["view"],classNameBindings:["content.completed","content.editing"],doubleClick:function(){this.get("content").set("editing",!0)},removeItem:function(){this.getPath("controller.content").removeObject(this.get("content"))},ItemEditorView:Ember.TextField.extend({valueBinding:"content.title",classNames:["edit"],change:function(){Ember.empty(this.getPath("content.title"))&&
this.getPath("controller.content").removeObject(this.get("content"))},whenDone:function(){this.get("content").set("editing",!1)},focusOut:function(){this.whenDone()},didInsertElement:function(){this.$().focus()},insertNewline:function(){this.whenDone()}})})});Todos.Router=Ember.Router.extend({root:Ember.Route.extend({showAll:Ember.Route.transitionTo("index"),showActive:Ember.Route.transitionTo("active"),showCompleted:Ember.Route.transitionTo("completed"),index:Ember.Route.extend({route:"/",connectOutlets:function(b){b=b.get("applicationController");var a=b.namespace.entriesController;a.set("filterBy","");b.connectOutlet({viewClass:Todos.views.Items,controller:Todos.ctrls.Todos.create(),context:a})}}),active:Ember.Route.extend({route:"/active",connectOutlets:function(b){b=
b.get("applicationController");var a=b.namespace.entriesController;a.set("filterBy","active");b.connectOutlet({viewClass:Todos.views.Items,controller:Todos.ctrls.Todos.create(),context:a})}}),completed:Ember.Route.extend({route:"/completed",connectOutlets:function(b){b=b.get("applicationController");var a=b.namespace.entriesController;a.set("filterBy","completed");b.connectOutlet({viewClass:Todos.views.Items,controller:Todos.ctrls.Todos.create(),context:a})}}),specs:Ember.Route.extend({route:"/specs",
connectOutlets:Todos.helper})})});Todos.models={};Todos.models.Todo=Ember.Object.extend({id:null,title:null,completed:!1,store:null,todoChanged:function(){this.get("store").update(this)}.observes("title","completed")});Todos.models.Store=function(b){this.name=b;this.data=(b=localStorage.getItem(this.name))&&JSON.parse(b)||{};this.save=function(){localStorage.setItem(this.name,JSON.stringify(this.data))};this.createFromTitle=function(a){a=Todos.models.Todo.create({title:a,store:this});this.create(a);return a};this.create=function(a){a.get("id")||a.set("id",Date.now());return this.update(a)};this.update=function(a){this.data[a.get("id")]=a.getProperties("id","title","completed");this.save();return a};this.find=function(a){a=
Todos.models.Todo.create(this.data[a.get("id")]);a.set("store",this);return a};this.findAll=function(){var a=[],b;for(b in this.data){var d=Todos.models.Todo.create(this.data[b]);d.set("store",this);a.push(d)}return a};this.remove=function(a){delete this.data[a.get("id")];this.save();return a}};Todos.app={};yepnope({test:COMPILED,yep:["/dist/app-module-entries.min.js","/dist/app-module-application.min.js"],nope:["/js/app-module-entries.js","/js/app-module-application.js"],complete:Todos.app.init});
Todos.app.init=function(){Todos.App=Ember.Application.create({VERSION:"1.0",rootElement:"#todoapp",Router:Todos.Router,ApplicationController:Ember.Controller.extend(),ApplicationView:Todos.views.Application,entriesController:Todos.ctrls.Entries.create({store:new Todos.models.Store("todos-emberjs")}),templates:["clear_button","filters","items","stats"],ready:function(){this.loadTemplates(this.templates.shift())},loadTemplates:function(b){b?this.loadTemplate("js/app/templates/"+b+".html",b,this.loadTemplates):
this.initialize()},loadTemplate:function(b,a,c){var d=this;$.get(b,function(b){b=Ember.Handlebars.compile(b);Ember.TEMPLATES[a]=b;c.call(d,d.templates.shift())})}})};}
